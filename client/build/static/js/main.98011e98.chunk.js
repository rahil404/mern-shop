(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{160:function(e,t,a){},162:function(e,t,a){},180:function(e,t,a){},191:function(e,t,a){},192:function(e,t,a){},193:function(e,t,a){},194:function(e,t,a){},318:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a(0),r=a.n(c),s=a(23),o=a.n(s),i=(a(160),a(6)),l=a.n(i),d=a(13),u=a(4),j=(a(162),a(10)),b=a(12),h=a(8),p=a.n(h),g=(a(180),a(144)),m=a.n(g),x=Object(c.createContext)(),O=function(e){var t=e.reducer,a=e.initialState,r=e.children;return Object(n.jsx)(x.Provider,{value:Object(c.useReducer)(t,a),children:r})},v=function(){return Object(c.useContext)(x)},f=(a(142),a(54)),y=a.n(f);var S=function(){Object(b.g)();var e=v(),t=Object(u.a)(e,1)[0],a=t.basket,c=(t.user,t.purchases,localStorage.getItem("customerLoggedIn"));return Object(n.jsxs)("nav",{className:"navbar navbar-expand-lg fixed-top navbar-dark bg-dark",children:[Object(n.jsx)(y.a,{left:!0,children:Object(n.jsxs)(j.b,{to:"/",children:[Object(n.jsx)("img",{style:{width:"50px",position:"relative",top:"-10px"},className:"header__logo",src:"https://res.cloudinary.com/dr1xkn8l3/image/upload/v1614055064/logo1_snqcpl.png",alt:""}),Object(n.jsx)("a",{style:{fontWeight:"bold"},className:"navbar-brand",href:"#",children:"Online-Shop"})]})}),Object(n.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(n.jsx)("span",{className:"navbar-toggler-icon"})}),Object(n.jsx)(y.a,{right:!0,children:Object(n.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(n.jsx)("div",{className:"header__nav ml-auto",children:c?Object(n.jsxs)("div",{className:"header__loggedin__list",children:[Object(n.jsx)(j.b,{to:"/purchased",children:Object(n.jsx)("a",{style:{color:"white"},className:"header__optionBasket",children:"Purchased Items"})}),Object(n.jsx)(j.b,{to:"/checkout",children:Object(n.jsxs)("div",{style:{color:"white"},className:"header__optionBasket",children:[Object(n.jsx)(m.a,{}),Object(n.jsx)("span",{className:"header__optionLineTwo header__basketCount",children:null===a||void 0===a?void 0:a.length})]})}),Object(n.jsx)("button",{onClick:function(e){e.preventDefault(),localStorage.removeItem("auth-token"),localStorage.removeItem("user"),localStorage.removeItem("customerLoggedIn"),localStorage.removeItem("user-email"),window.location.reload(!1)},className:"btn btn-sm btn-secondary",children:"Logout"})]}):Object(n.jsx)(j.b,{style:{marginRight:"20px"},to:"/signin",children:Object(n.jsx)("button",{className:"btn btn-md btn-secondary",children:"Login"})})})})})]})},k=(a(191),a(192),a(343)),N=a(341);var _=function(e){var t=e.id,a=e.title,r=e.image,s=e.price,o=e.rating,i=v(),l=Object(u.a)(i,2),d=l[0].basket,j=l[1],b=Object(c.useState)({}),h=Object(u.a)(b,2),p=(h[0],h[1],localStorage.getItem("customerLoggedIn"));return Object(n.jsxs)("div",{className:"product",children:[Object(n.jsxs)("div",{className:"product__info",children:[Object(n.jsx)("p",{children:a}),Object(n.jsxs)("p",{className:"product__price",children:[Object(n.jsx)("small",{children:"$"}),Object(n.jsx)("strong",{children:s})]}),o<1?Object(n.jsx)("i",{children:"(0 ratings given)"}):Object(n.jsx)(N.a,{component:"fieldset",mb:3,borderColor:"transparent",children:Object(n.jsx)(k.a,{name:"read-only",value:o,readOnly:!0})})]}),Object(n.jsx)("img",{src:r,alt:""}),p?Object(n.jsx)("button",{onClick:function(){var e=d.find((function(e){return e.id===t}));console.log(e),e?(console.log(e),j({type:"UPDATE_BASKET",item:{id:t,title:a,image:r,price:s,rating:o,quantity:e.quantity+1}})):j({type:"ADD_TO_BASKET",item:{id:t,title:a,image:r,price:s,rating:o,quantity:1}}),console.log(d)},children:"Add to Basket"}):Object(n.jsx)("span",{className:"d-inline-block",tabindex:"0","data-toggle":"tooltip",title:"Login is required to add items",children:Object(n.jsx)("button",{style:{pointerEvents:"none"},type:"button",disabled:!0,children:"Add to Basket"})})]})},I=a(58),C=a(345);var w=function(e){var t=v(),a=Object(u.a)(t,2),r=a[0].products,s=(a[1],Object(c.useState)(1)),o=Object(u.a)(s,2),i=o[0],l=o[1];function d(e){return e.length<1?0:e.reduce((function(e,t){return e+t}))/e.length}var j=function(e){l(e)};return Object(n.jsxs)("div",{className:"home",style:{backgroundColor:"#ebebe0"},children:[Object(n.jsxs)(I.a,{interval:4e3,style:{marginBottom:"-120px"},children:[Object(n.jsx)(I.a.Item,{children:Object(n.jsx)("img",{style:{height:"750px"},className:"d-block w-100",src:"https://images.pexels.com/photos/2447042/pexels-photo-2447042.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940",alt:"First slide"})}),Object(n.jsx)(I.a.Item,{children:Object(n.jsx)("img",{style:{height:"750px"},className:"d-block w-100",src:"https://images.pexels.com/photos/6230456/pexels-photo-6230456.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940",alt:"Third slide"})}),Object(n.jsx)(I.a.Item,{children:Object(n.jsx)("img",{style:{height:"750px"},className:"d-block w-100",src:"https://images.pexels.com/photos/341523/pexels-photo-341523.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940",alt:"Third slide"})})]}),Object(n.jsx)(y.a,{bottom:!0,children:Object(n.jsxs)("div",{className:"home__row",children:[r[5*(i-1)+0]?Object(n.jsx)(_,{id:"111",title:r[5*(i-1)+0]&&r[5*(i-1)+0].name,price:r[5*(i-1)+0]&&r[5*(i-1)+0].price,rating:d(r[5*(i-1)+0].rating),image:r[5*(i-1)+0]&&r[5*(i-1)+0].image}):null,r[5*(i-1)+1]?Object(n.jsx)(_,{id:"222",title:r[5*(i-1)+1]&&r[5*(i-1)+1].name,price:r[5*(i-1)+1]&&r[5*(i-1)+1].price,rating:d(r[5*(i-1)+1].rating),image:r[5*(i-1)+1]&&r[5*(i-1)+1].image}):null]})}),Object(n.jsxs)("div",{className:"home__row",children:[r[5*(i-1)+2]?Object(n.jsx)(_,{id:"333",title:r[5*(i-1)+2]&&r[5*(i-1)+2].name,price:r[5*(i-1)+2]&&r[5*(i-1)+2].price,rating:d(r[5*(i-1)+2].rating),image:r[5*(i-1)+2]&&r[5*(i-1)+2].image}):null,r[5*(i-1)+3]?Object(n.jsx)(_,{id:"444",title:r[5*(i-1)+3]&&r[5*(i-1)+3].name,price:r[5*(i-1)+3]&&r[5*(i-1)+3].price,rating:d(r[5*(i-1)+3].rating),image:r[5*(i-1)+3]&&r[5*(i-1)+3].image}):null,r[5*(i-1)+4]?Object(n.jsx)(_,{id:"555",title:r[5*(i-1)+4]&&r[5*(i-1)+4].name,price:r[5*(i-1)+4]&&r[5*(i-1)+4].price,rating:d(r[5*(i-1)+4].rating),image:r[5*(i-1)+4]&&r[5*(i-1)+4].image}):null]}),e.products.length>5?Object(n.jsx)("div",{style:{marginTop:"20px"},className:"d-flex justify-content-center",children:Object(n.jsxs)(C.a,{children:[1!=i?Object(n.jsx)(C.a.Prev,{onClick:function(){return j(i-1)}}):null,Object(n.jsx)(C.a.Item,{active:1===i,onClick:function(){return j(1)},children:1}),Object(n.jsx)(C.a.Item,{active:2===i,onClick:function(){return j(2)},children:2}),Math.floor(e.products.length/5)+1==3?Object(n.jsx)(C.a.Item,{active:3===i,onClick:function(){return j(3)},children:3}):null,Math.floor(e.products.length/5)+1==2&&2!=i||Math.floor(e.products.length/5)+1==3&&3!=i?Object(n.jsx)(C.a.Next,{onClick:function(){return j(i+1)}}):null]})}):null]})};a(193);var T=function(e){var t=e.id,a=e.title,c=e.image,r=e.price,s=e.rating,o=e.quantity,i=v(),l=Object(u.a)(i,2),d=(l[0].basket,l[1]);return Object(n.jsxs)("div",{className:"checkoutProduct",children:[Object(n.jsx)("img",{className:"checkoutProduct__image",src:c,alt:""}),Object(n.jsxs)("div",{className:"checkoutProduct__info",children:[Object(n.jsx)("p",{className:"checkoutProduct__title",children:a}),s<1?Object(n.jsx)("i",{children:"(0 ratings given)"}):Object(n.jsx)(N.a,{component:"fieldset",mb:3,borderColor:"transparent",children:Object(n.jsx)(k.a,{name:"read-only",value:s,readOnly:!0})}),Object(n.jsxs)("p",{className:"checkoutProduct__price",children:[Object(n.jsx)("small",{children:"$"}),Object(n.jsxs)("strong",{children:[r," "]}),"| Qty: ",Object(n.jsx)("span",{className:"badge badge-dark",children:o}),"\xa0",Object(n.jsx)("button",{onClick:function(){d({type:"UPDATE_BASKET",item:{id:t,title:a,image:c,price:r,rating:s,quantity:o+1}})},style:{border:"1px solid lightgrey"},className:"btn btn-sm",children:"+"}),"\xa0",Object(n.jsx)("button",{onClick:function(){d({type:"UPDATE_BASKET",item:{id:t,title:a,image:c,price:r,rating:s,quantity:o-1}})},style:{border:"1px solid lightgrey"},className:"btn btn-sm",children:"-"})]}),Object(n.jsx)("p",{}),Object(n.jsx)("button",{onClick:function(){d({type:"REMOVE_FROM_BASKET",id:t})},children:"Remove from Basket"})]})]})},E=(a(194),a(37));var A=a(339),P=a(342),D=function(e){var t=v(),a=Object(u.a)(t,2),r=a[0].basket,s=a[1];console.log("amount in ..",e.amount);var o=Object(c.useState)(""),i=Object(u.a)(o,2),j=i[0],b=(i[1],Object(c.useState)(!1)),h=Object(u.a)(b,2),g=h[0],m=h[1],x=localStorage.getItem("user-email"),O=localStorage.getItem("auth-token"),f=Object(E.useStripe)(),y=Object(E.useElements)(),S=new Date,k=String(S.getDate()).padStart(2,"0"),N=String(S.getMonth()+1).padStart(2,"0"),_=S.getFullYear();S=_+"-"+N+"-"+k;var I=function(){var t=Object(d.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),f&&y){t.next=5;break}return t.abrupt("return");case 5:console.log("loaded");case 6:return t.next=8,p.a.post("/api/pay",{email:j,amount:e.amount}).then(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),200==t.status&&(console.log("payment succeded !"),m(!0),r.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.id),a={user:x,product:t.title,image:t.image,price:t.price,quantity:t.quantity,date:S},e.next=4,p.a.post("/api/purchases/add",a,{headers:{"x-auth-token":O}}).then((function(e){console.log(e),s({type:"ADD_PURCHASE",purchase:a}),s({type:"REMOVE_FROM_BASKET",id:t.id})}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),window.location.reload(!1),console.log(r));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsxs)("div",{style:{marginTop:"-25px"},children:[Object(n.jsx)(A.a,{children:Object(n.jsxs)("form",{onSubmit:I,children:[Object(n.jsxs)("div",{class:"form-group",children:[Object(n.jsx)("label",{for:"ccc",children:"Card Number"}),Object(n.jsx)("input",{required:!0,className:"form-control",id:"ccc",type:"tel",inputmode:"numeric",pattern:"[0-9\\s]{13,19}",autocomplete:"cc-number",maxlength:"19",placeholder:"xxxx xxxx xxxx xxxx"})]}),Object(n.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Pay"})]})}),Object(n.jsx)("div",{style:{position:"relative",top:"500px"},children:g?Object(n.jsx)(P.a,{onClose:function(){return m(!1)},children:"Payment succeeded!"}):null})]})},R=a(148),L=a(149),q=a.n(L),B=a(45),U=a(14),F=function(e){return null===e||void 0===e?void 0:e.reduce((function(e,t){return t.price*t.quantity+e}),0)};var H=function(e,t){switch(console.log(t),t.type){case"SET_TOKEN":return Object(U.a)(Object(U.a)({},e),{},{token:t.token});case"SET_PRODUCTS":return Object(U.a)(Object(U.a)({},e),{},{products:t.products});case"SET_PURCHASES":return Object(U.a)(Object(U.a)({},e),{},{purchases:t.purchases});case"ADD_PURCHASE":return Object(U.a)(Object(U.a)({},e),{},{purchases:[].concat(Object(B.a)(e.purchases),[t.purchase])});case"SET_USER":return Object(U.a)(Object(U.a)({},e),{},{user:t.user});case"ADD_TO_BASKET":return Object(U.a)(Object(U.a)({},e),{},{basket:[].concat(Object(B.a)(e.basket),[t.item])});case"UPDATE_BASKET":console.log(t.item);var a=e.basket.findIndex((function(e){return e.id===t.item.id}));return console.log(a),Object(U.a)(Object(U.a)({},e),{},{basket:[].concat(Object(B.a)(e.basket.slice(0,a)),[t.item],Object(B.a)(e.basket.slice(a+1)))});case"REMOVE_FROM_BASKET":var n=Object(B.a)(e.basket),c=e.basket.findIndex((function(e){return e.id===t.id}));return c>=0?n.splice(c,1):console.warn("Cant remove product as no item with the id"),Object(U.a)(Object(U.a)({},e),{},{basket:n});default:return e}},M=Object(R.a)("pk_test_51I8YnYKYfFgj9AHVZKUt39Do0F1qRy6DYUGm8DsXVlATrBaPN0N5FZQapH6yzivEzSbH1rSnPQmm5xRRYCycEQPB00gO7PU6o4");var K=function(){var e=v(),t=Object(u.a)(e,2),a=t[0],r=a.basket,s=a.showAlert,o=t[1],i=Object(c.useState)(""),l=Object(u.a)(i,2),d=l[0],j=l[1],h=localStorage.getItem("customerLoggedIn");return console.log(h),h?Object(n.jsxs)("div",{className:"checkout",style:{marginTop:"80px"},children:[s?Object(n.jsx)(P.a,{onClose:function(){o({type:"HIDE_ALERT"})},children:"Payment succeeded!"}):null,Object(n.jsxs)("div",{className:"checkout__left",children:[Object(n.jsx)("a",{href:"#",children:Object(n.jsx)("img",{className:"checkout__ad",src:"https://images.pexels.com/photos/2292953/pexels-photo-2292953.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=1250&w=1840"})}),0===(null===r||void 0===r?void 0:r.length)?Object(n.jsxs)("div",{children:[Object(n.jsx)("h2",{children:"Basket is empty"}),Object(n.jsx)("p",{children:'You have no items in your basket. Click "Add to Basket" to add items.'})]}):Object(n.jsxs)("div",{children:[Object(n.jsx)("h2",{className:"checkout__title",children:"Your basket"}),r.map((function(e){return Object(n.jsx)(T,{id:e.id,title:e.title,image:e.image,price:e.price,rating:e.rating,quantity:e.quantity})}))]})]}),r.length>0&&Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:"subtotal",children:[Object(n.jsx)(q.a,{renderText:function(e){return j(e),Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("p",{style:{paddingLeft:"15px"},children:["Subtotal (",r.length," item/s): ",Object(n.jsx)("strong",{children:"".concat(e)})]})})},decimalScale:2,value:F(r),displayType:"text",thousandSeparator:!0,prefix:"$"}),Object(n.jsx)(E.Elements,{style:{position:"relative",bottom:"50px"},stripe:M,children:Object(n.jsx)(D,{amount:d})})]})})]}):Object(n.jsx)(b.a,{to:"/"})};a(76);var Y=function(){var e=Object(b.g)(),t=Object(c.useState)(""),a=Object(u.a)(t,2),r=a[0],s=a[1],o=Object(c.useState)(""),i=Object(u.a)(o,2),l=i[0],d=i[1],j=Object(c.useState)(!1),h=Object(u.a)(j,2),g=h[0],m=h[1];return localStorage.getItem("user"),localStorage.getItem("adminLoggedIn")?Object(n.jsx)(b.a,{to:"/dashboard"}):Object(n.jsx)("div",{className:"login",children:Object(n.jsxs)("div",{className:"login__container",children:[Object(n.jsx)("h1",{children:"Sign in"}),Object(n.jsxs)("form",{onSubmit:function(t){t.preventDefault();var a={email:r,password:l};p.a.post("/api/auth",a).then((function(t){console.log("logged in",t.data),t.data.user.isAdmin?(localStorage.removeItem("customerLoggedIn"),localStorage.setItem("adminLoggedIn",!0),localStorage.setItem("auth-token",t.data.token),localStorage.setItem("user",t.data.user.name),e.push("/dashboard")):m(!0)})).catch((function(e){m(!0),console.log("failed logged in",e)}))},children:[Object(n.jsx)("h5",{children:"E-mail"}),Object(n.jsx)("input",{required:!0,type:"email",value:r,onChange:function(e){return s(e.target.value)}}),Object(n.jsx)("h5",{children:"Password"}),Object(n.jsx)("input",{required:!0,type:"password",value:l,onChange:function(e){return d(e.target.value)}}),Object(n.jsx)("button",{type:"submit",className:"login__signInButton",children:"Sign In"})]}),Object(n.jsx)("div",{style:{marginTop:"5px"},children:g?Object(n.jsx)(P.a,{severity:"error",onClose:function(){return m(!1)},children:"Incorrect email or password"}):null})]})})};var G=function(){var e=Object(b.i)();console.log(e);var t=Object(b.g)(),a=Object(b.h)();console.log(a);var r=v(),s=Object(u.a)(r,2),o=(s[0].products,s[1]),i=localStorage.getItem("user"),h=localStorage.getItem("adminLoggedIn"),g=localStorage.getItem("auth-token"),m=Object(c.useState)(a.state.name),x=Object(u.a)(m,2),O=x[0],f=x[1],y=Object(c.useState)(a.state.price),S=Object(u.a)(y,2),k=S[0],N=S[1],_=Object(c.useState)(a.state.desc),I=Object(u.a)(_,2),C=I[0],w=I[1],T=Object(c.useState)(""),E=Object(u.a)(T,2),A=E[0],D=E[1],R=Object(c.useState)(!1),L=Object(u.a)(R,2),q=L[0],B=L[1],U=function(){var t=Object(d.a)(l.a.mark((function t(a){var n,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n={name:O,price:k,desc:C},""==A){t.next=10;break}return(c=new FormData).append("file",A),c.append("upload_preset","jngmzxpk"),t.next=8,p.a.post("https://api.cloudinary.com/v1_1/dr1xkn8l3/image/upload",c).then(function(){var t=Object(d.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a.data.secure_url),n={name:O,price:k,desc:C,image:a.data.secure_url},t.next=4,p.a.post("/api/products/update/"+e.id,n,{headers:{"x-auth-token":g}}).then(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.data),e.next=3,p.a.get("/api/products");case 3:a=e.sent,console.log(a.data),o({type:"SET_PRODUCTS",products:a.data});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 8:t.next=12;break;case 10:return t.next=12,p.a.post("/api/products/update/"+e.id,n,{headers:{"x-auth-token":g}}).then(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.data),B(!0),e.next=4,p.a.get("/api/products");case 4:a=e.sent,console.log(a.data),o({type:"SET_PRODUCTS",products:a.data});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 12:console.log(n);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return h?Object(n.jsxs)("div",{children:[Object(n.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:[Object(n.jsx)(j.b,{to:"/admin",children:Object(n.jsx)("a",{className:"navbar-brand",href:"#",children:"Admin Area"})}),Object(n.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(n.jsx)("span",{className:"navbar-toggler-icon"})}),Object(n.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(n.jsxs)("div",{className:"navbar-nav ml-auto",children:[Object(n.jsx)("p",{style:{marginRight:"5px"},children:Object(n.jsxs)("b",{children:["Hello, ",i]})}),Object(n.jsx)("button",{style:{height:"40%"},className:"btn btn-primary btn-sm",onClick:function(e){e.preventDefault(),localStorage.removeItem("adminLoggedIn"),localStorage.setItem("auth-token",""),localStorage.setItem("user",""),t.push("/admin")},children:"Logout"})]})})]}),Object(n.jsxs)("div",{style:{margin:"30px auto",width:"40%"},children:[q?Object(n.jsx)(P.a,{onClose:function(){return B(!1)},children:"Product updated!"}):null,Object(n.jsx)("h4",{style:{textAlign:"center"},children:"Edit Product"}),Object(n.jsxs)("form",{style:{backgroundColor:"lightgrey"},className:"rounded p-3",onSubmit:U,children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Name"}),Object(n.jsx)("input",{required:!0,className:"form-control",type:"text",value:O,onChange:function(e){return f(e.target.value)}})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Price"}),Object(n.jsx)("input",{required:!0,className:"form-control",type:"number",value:k,onChange:function(e){return N(e.target.value)}})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Description"}),Object(n.jsx)("textarea",{required:!0,className:"form-control",rows:"4",cols:"50",value:C,onChange:function(e){return w(e.target.value)}})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Image"}),Object(n.jsx)("input",{className:"form-control",type:"file",onChange:function(e){return D(e.target.files[0])}})]}),Object(n.jsx)("button",{style:{clear:"both"},type:"submit",className:"btn btn-primary",children:"Update"})]}),Object(n.jsx)(j.b,{style:{float:"right",marginTop:"10px"},className:"btn btn-link",to:"/dashboard",children:"Go Back"})]})]}):Object(n.jsx)(b.a,{to:"/admin"})};var V=function(){var e=Object(b.g)(),t=v(),a=Object(u.a)(t,2),r=(a[0].products,a[1]),s=localStorage.getItem("user"),o=localStorage.getItem("adminLoggedIn"),i=localStorage.getItem("auth-token"),h=Object(c.useState)(""),g=Object(u.a)(h,2),m=g[0],x=g[1],O=Object(c.useState)(""),f=Object(u.a)(O,2),y=f[0],S=f[1],k=Object(c.useState)(""),N=Object(u.a)(k,2),_=N[0],I=N[1],C=Object(c.useState)(""),w=Object(u.a)(C,2),T=w[0],E=w[1],A=Object(c.useState)(!1),D=Object(u.a)(A,2),R=D[0],L=D[1];console.log(T);var q=function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),(a=new FormData).append("file",T),a.append("upload_preset","jngmzxpk"),e.next=6,p.a.post("https://api.cloudinary.com/v1_1/dr1xkn8l3/image/upload",a).then(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.data.secure_url),a={name:m,price:y,desc:_,image:t.data.secure_url},console.log(a),e.next=5,p.a.post("/api/products/add",a,{headers:{"x-auth-token":i}}).then(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.data),L(!0),x(""),S(""),I(""),e.next=7,p.a.get("/api/products");case 7:a=e.sent,console.log(a.data),r({type:"SET_PRODUCTS",products:a.data});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:E("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o?Object(n.jsxs)("div",{children:[Object(n.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:[Object(n.jsx)(j.b,{to:"/dashboard",children:Object(n.jsx)("a",{className:"navbar-brand",href:"#",children:"Admin Area"})}),Object(n.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(n.jsx)("span",{className:"navbar-toggler-icon"})}),Object(n.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(n.jsxs)("div",{className:"navbar-nav ml-auto",children:[Object(n.jsx)("p",{style:{marginRight:"5px"},children:Object(n.jsxs)("b",{children:["Hello, ",s]})}),Object(n.jsx)("button",{style:{height:"40%"},className:"btn btn-primary btn-sm",onClick:function(t){t.preventDefault(),localStorage.removeItem("adminLoggedIn"),localStorage.setItem("auth-token",""),localStorage.setItem("user",""),e.push("/admin")},children:"Logout"})]})})]}),Object(n.jsxs)("div",{style:{margin:"30px auto",width:"40%"},children:[R?Object(n.jsx)(P.a,{onClose:function(){return L(!1)},children:"Product added!"}):null,Object(n.jsx)("h4",{style:{textAlign:"center"},children:"Add a New Product"}),Object(n.jsxs)("form",{style:{backgroundColor:"lightgrey"},className:"rounded p-3",onSubmit:q,children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Name"}),Object(n.jsx)("input",{required:!0,className:"form-control",type:"text",value:m,onChange:function(e){return x(e.target.value)}})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Price"}),Object(n.jsx)("input",{required:!0,className:"form-control",type:"number",value:y,onChange:function(e){return S(e.target.value)}})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Description"}),Object(n.jsx)("textarea",{required:!0,className:"form-control",rows:"4",cols:"50",value:_,onChange:function(e){return I(e.target.value)}})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("h5",{children:"Image"}),Object(n.jsx)("input",{required:!0,className:"form-control",type:"file",onChange:function(e){return E(e.target.files[0])}})]}),Object(n.jsx)("button",{style:{clear:"both"},type:"submit",className:"btn btn-primary",children:"Add Product"})]}),Object(n.jsx)(j.b,{style:{float:"right",marginTop:"10px"},className:"btn btn-link",to:"/dashboard",children:"Go Back"})]})]}):Object(n.jsx)(b.a,{to:"/admin"})},Q=a(73);var z=function(){var e=localStorage.getItem("auth-token"),t=v(),a=Object(u.a)(t,2),c=a[0].products,r=a[1],s=function(e){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:Object(n.jsx)(Q.Image,{style:{width:"40px"},cloudName:"dr1xkn8l3",publicId:e.product.image})}),Object(n.jsx)("td",{children:e.product.name}),Object(n.jsx)("td",{children:e.product.price}),Object(n.jsx)("td",{children:e.product.desc}),Object(n.jsx)("td",{children:e.product.register_date.substring(0,10)}),Object(n.jsxs)("td",{children:[Object(n.jsx)(j.b,{to:{pathname:"/products/edit/"+e.product._id,state:{name:e.product.name,price:e.product.price,desc:e.product.desc}},children:"Edit"})," | ",Object(n.jsx)("a",{style:{color:"red"},href:"#",onClick:function(){window.confirm("Delete the product?")&&e.deleteProduct(e.product._id)},children:"Delete"})]})]})},o=Object(b.g)(),i=localStorage.getItem("user"),l=localStorage.getItem("adminLoggedIn"),d=function(t){p.a.delete("/api/products/"+t,{headers:{"x-auth-token":e}}).then((function(e){r({type:"SET_PRODUCTS",products:c.filter((function(e){return e._id!==t}))})}))};return l?Object(n.jsxs)("div",{children:[Object(n.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:[Object(n.jsx)("a",{className:"navbar-brand",href:"#",children:"Admin Area"}),Object(n.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(n.jsx)("span",{className:"navbar-toggler-icon"})}),Object(n.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(n.jsxs)("div",{className:"navbar-nav ml-auto",children:[Object(n.jsx)("p",{style:{marginRight:"5px"},children:Object(n.jsxs)("b",{children:["Hello, ",i]})}),Object(n.jsx)("button",{style:{height:"40%"},className:"btn btn-primary btn-sm",onClick:function(e){e.preventDefault(),localStorage.removeItem("adminLoggedIn"),localStorage.setItem("auth-token",""),localStorage.setItem("user",""),o.push("/admin")},children:"Logout"})]})})]}),Object(n.jsxs)("div",{style:{margin:"30px auto",width:"75%"},children:[Object(n.jsx)("h4",{style:{clear:"both",float:"left"},children:"Product List"}),Object(n.jsx)(j.b,{style:{float:"right"},className:"btn btn-success btn-sm",to:"/products/add",children:"Add Product"}),Object(n.jsxs)("table",{className:"table",children:[Object(n.jsx)("thead",{className:"thead-light",children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{}),Object(n.jsx)("th",{children:"Name"}),Object(n.jsx)("th",{children:"Price"}),Object(n.jsx)("th",{children:"Description"}),Object(n.jsx)("th",{children:"Date"}),Object(n.jsx)("th",{children:"Actions"})]})}),Object(n.jsx)("tbody",{children:c.map((function(e){return Object(n.jsx)(s,{product:e,deleteProduct:d},e._id)}))})]})]})]}):Object(n.jsx)(b.a,{to:"/admin"})};var W=function(){var e=v(),t=Object(u.a)(e,2),a=(t[0].products,t[1]),r=Object(b.g)(),s=Object(c.useState)(""),o=Object(u.a)(s,2),i=o[0],h=o[1],g=Object(c.useState)(""),m=Object(u.a)(g,2),x=m[0],O=m[1],f=Object(c.useState)(!1),y=Object(u.a)(f,2),S=y[0],k=y[1];return Object(n.jsxs)("div",{children:[Object(n.jsxs)("nav",{className:"navbar navbar-expand-lg fixed-top navbar-dark bg-dark",children:[Object(n.jsxs)(j.b,{to:"/",children:[Object(n.jsx)("img",{style:{width:"50px",position:"relative",top:"-10px"},className:"header__logo",src:"logo1.png",alt:""}),Object(n.jsx)("a",{style:{fontWeight:"bold"},className:"navbar-brand",href:"#",children:"Online-Shop"})]}),Object(n.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(n.jsx)("span",{className:"navbar-toggler-icon"})})]}),Object(n.jsx)("div",{style:{position:"relative",top:"100px"},className:"login",children:Object(n.jsxs)("div",{className:"login__container",children:[Object(n.jsx)("h1",{children:"Sign in"}),Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={email:i,password:x};p.a.post("/api/users/login",t).then(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("logged in",t.data),t.data.token){e.next=5;break}console.log(t),e.next=13;break;case 5:return e.next=7,p.a.get("/api/purchases/"+t.data.user.email,{headers:{"x-auth-token":t.data.token}}).then((function(e){console.log(e.data),a({type:"SET_PURCHASES",purchases:e.data})}));case 7:localStorage.setItem("auth-token",t.data.token),localStorage.setItem("user",t.data.user.name),localStorage.setItem("user-email",t.data.user.email),localStorage.setItem("customerLoggedIn",!0),localStorage.removeItem("adminLoggedIn"),r.push("/");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){k(!0),console.log("failed logged in",e)}))},children:[Object(n.jsx)("h5",{children:"E-mail"}),Object(n.jsx)("input",{required:!0,type:"email",value:i,onChange:function(e){return h(e.target.value)}}),Object(n.jsx)("h5",{children:"Password"}),Object(n.jsx)("input",{required:!0,type:"password",value:x,onChange:function(e){return O(e.target.value)}}),Object(n.jsx)("button",{type:"submit",className:"login__signInButton",children:"Sign In"})]}),Object(n.jsx)("div",{style:{marginTop:"8px"},children:S?Object(n.jsx)(P.a,{severity:"error",onClose:function(){return k(!1)},children:"Incorrect email or password"}):null}),Object(n.jsx)("p",{style:{textAlign:"center",fontWeight:"bold"},children:"Not a user?"}),Object(n.jsx)("button",{onClick:function(e){r.push("/signup")},className:"login__registerButton",children:"Create an Account"})]})})]})};var $=function(){var e=v(),t=Object(u.a)(e,2),a=(t[0].products,t[1]),r=Object(b.g)(),s=Object(c.useState)(""),o=Object(u.a)(s,2),i=o[0],j=o[1],h=Object(c.useState)(""),g=Object(u.a)(h,2),m=g[0],x=g[1],O=Object(c.useState)(""),f=Object(u.a)(O,2),y=f[0],S=f[1];return Object(n.jsx)("div",{style:{marginTop:"100px"},className:"login",children:Object(n.jsxs)("div",{className:"login__container",children:[Object(n.jsx)("h1",{children:"Create an Account"}),Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={name:m,email:i,password:y};p.a.post("/api/users/create",t).then(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("registered and logged in",t.data),e.next=3,p.a.get("/api/purchases/"+t.data.user.email,{headers:{"x-auth-token":t.data.token}}).then((function(e){console.log(e.data),a({type:"SET_PURCHASES",purchases:e.data})}));case 3:localStorage.setItem("auth-token",t.data.token),localStorage.setItem("user",t.data.user.name),localStorage.setItem("user-email",t.data.user.email),localStorage.setItem("customerLoggedIn",!0),r.push("/");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:[Object(n.jsx)("h5",{children:"Full Name"}),Object(n.jsx)("input",{required:!0,type:"text",value:m,onChange:function(e){return x(e.target.value)}}),Object(n.jsx)("h5",{children:"E-mail"}),Object(n.jsx)("input",{required:!0,type:"email",value:i,onChange:function(e){return j(e.target.value)}}),Object(n.jsx)("h5",{children:"Password"}),Object(n.jsx)("input",{required:!0,type:"password",value:y,onChange:function(e){return S(e.target.value)}}),Object(n.jsx)("button",{type:"submit",className:"login__signInButton",children:"Register"})]})]})})};var J=function(){var e=v(),t=Object(u.a)(e,2),a=t[0].purchases,r=(t[1],Object(c.useState)(2)),s=Object(u.a)(r,2),o=s[0],i=s[1],j=localStorage.getItem("customerLoggedIn"),h=localStorage.getItem("auth-token"),g=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a[t].image),console.log(o),n={image:a[t].image,rating:o},e.next=5,p.a.post("/api/products/update_rating",n,{headers:{"x-auth-token":h}}).then((function(e){console.log(e)}));case 5:return e.next=7,p.a.post("/api/purchases/update_rating_given",{id:a[t]._id},{headers:{"x-auth-token":h}}).then((function(e){console.log(e)}));case 7:window.location.reload(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return j?a.length<1?Object(n.jsx)("p",{style:{textStyle:"italic",marginTop:"100px",textAlign:"center"},children:"You have not purchased any items."}):Object(n.jsx)("div",{style:{marginTop:"100px"},children:Object(n.jsxs)("div",{style:{width:"70%",margin:"0 auto"},children:[Object(n.jsx)("h4",{style:{clear:"both",float:"left"},children:"Purchased Items"}),Object(n.jsxs)("table",{className:"table",children:[Object(n.jsx)("thead",{className:"thead-light",children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{}),Object(n.jsx)("th",{children:"Title"}),Object(n.jsx)("th",{children:"Unit Price (\u20ac)"}),Object(n.jsx)("th",{children:"Quantity"}),Object(n.jsx)("th",{children:"Date"}),Object(n.jsx)("th",{children:"Rating"})]})}),Object(n.jsx)("tbody",{children:a.map((function(e,t){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:Object(n.jsx)(Q.Image,{style:{width:"40px"},cloudName:"dr1xkn8l3",publicId:e.image})}),Object(n.jsx)("td",{children:e.product}),Object(n.jsx)("td",{children:e.price}),Object(n.jsx)("td",{children:e.quantity}),e.date?Object(n.jsx)("td",{children:e.date}):Object(n.jsx)("td",{children:e.register_date.substring(0,10)}),Object(n.jsx)("td",{children:1==e.ratingGiven?Object(n.jsx)("p",{children:"Rating submitted"}):Object(n.jsxs)("div",{children:[Object(n.jsx)("button",{type:"button",className:"btn btn-primary","data-toggle":"modal","data-target":"#myModal-".concat(t.toString()),children:"Give Rating"}),Object(n.jsx)("div",{className:"modal",id:"myModal-".concat(t.toString()),children:Object(n.jsx)("div",{className:"modal-dialog",children:Object(n.jsxs)("div",{className:"modal-content",children:[Object(n.jsxs)("div",{className:"modal-header",children:[Object(n.jsx)("h4",{className:"modal-title",children:"Give Rating"}),Object(n.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:"\xd7"})]}),Object(n.jsxs)("div",{className:"modal-body",children:[Object(n.jsx)(N.a,{component:"fieldset",mb:3,borderColor:"transparent",children:Object(n.jsx)(k.a,{name:"simple-controlled",value:o,onChange:function(e,t){i(t)}})}),Object(n.jsx)("button",{type:"button",onClick:function(){g(t)},className:"btn btn-success btn-sm",children:"Submit"})]}),Object(n.jsx)("div",{className:"modal-footer",children:Object(n.jsx)("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",children:"Cancel"})})]})})})]})})]})}))})]})]})}):Object(n.jsx)(b.a,{to:"/"})};a(314),a(315);var Z=function(){var e=v(),t=Object(u.a)(e,2),a=t[0],r=(a.user,a.products),s=(a.purchases,t[1]);return console.log("userRes.data"),Object(c.useEffect)((function(){(function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("userRes.data"),t=localStorage.getItem("auth-token"),a=localStorage.getItem("user-email"),null===t&&(localStorage.setItem("auth-token",""),t=""),e.next=6,p.a.post("/api/auth/tokenIsValid",null,{headers:{"x-auth-token":t}});case 6:if(!e.sent.data){e.next=17;break}return e.next=10,p.a.get("/api/auth/user",{headers:{"x-auth-token":t}});case 10:n=e.sent,console.log(n.data),n.data.isAdmin?(console.log("Admin"),localStorage.removeItem("customerLoggedIn"),localStorage.setItem("adminLoggedIn",!0)):(console.log("Not Admin"),localStorage.setItem("customerLoggedIn",!0),localStorage.removeItem("adminLoggedIn")),s({type:"SET_USER",user:n.data.name}),localStorage.setItem("user",n.data.name),e.next=19;break;case 17:localStorage.setItem("user",""),localStorage.setItem("auth-token","");case 19:return e.next=21,p.a.get("/api/products");case 21:return c=e.sent,console.log(c.data),s({type:"SET_PRODUCTS",products:c.data}),e.next=26,p.a.get("/api/purchases/"+a,{headers:{"x-auth-token":t}}).then((function(e){console.log(e.data),s({type:"SET_PURCHASES",purchases:e.data})}));case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(n.jsx)(j.a,{children:Object(n.jsx)("div",{className:"app",children:Object(n.jsxs)(b.d,{children:[Object(n.jsxs)(b.b,{path:"/checkout",children:[Object(n.jsx)(S,{}),Object(n.jsx)(K,{})]}),Object(n.jsx)(b.b,{path:"/admin",children:Object(n.jsx)(Y,{})}),Object(n.jsx)(b.b,{path:"/signin",children:Object(n.jsx)(W,{})}),Object(n.jsxs)(b.b,{path:"/signup",children:[Object(n.jsx)(S,{}),Object(n.jsx)($,{})]}),Object(n.jsxs)(b.b,{path:"/purchased",children:[Object(n.jsx)(S,{}),Object(n.jsx)(J,{})]}),Object(n.jsx)(b.b,{path:"/dashboard",children:Object(n.jsx)(z,{})}),Object(n.jsx)(b.b,{path:"/products/edit/:id",children:Object(n.jsx)(G,{})}),Object(n.jsx)(b.b,{path:"/products/add",children:Object(n.jsx)(V,{})}),Object(n.jsxs)(b.b,{path:"/",children:[Object(n.jsx)(S,{}),Object(n.jsx)(w,{products:r})]})]})})})},X=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,347)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)}))};o.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(O,{initialState:{basket:[],products:[],purchases:[],user:null},reducer:H,children:Object(n.jsx)(Z,{})})}),document.getElementById("root")),X()},76:function(e,t,a){}},[[318,1,2]]]);
//# sourceMappingURL=main.98011e98.chunk.js.map